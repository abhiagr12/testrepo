<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
		xmlns:context="http://www.springframework.org/schema/context"
		xmlns:mvc="http://www.springframework.org/schema/mvc"
		xmlns:security="http://www.springframework.org/schema/security"
		xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
 			http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
 			http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
			http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">
	
	<context:component-scan base-package="com.controller" />
    <mvc:annotation-driven/>
	<!-- <mvc:resources mapping="/theme/**" location="/theme/" /> -->
	
	<security:http auto-config="true" authentication-manager-ref="authenticationManager">
		<security:intercept-url pattern="/login*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/logoutSuccess*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/theme/css/main.css" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/resources/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
	    <security:intercept-url pattern="/**" access="ROLE_USER" />
	    
	    <security:form-login login-page="/login" authentication-failure-url="/login"/>
	</security:http>
	
	<bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource" />
    
    <bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver" />
	
	<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    	<property name="prefix" value="/WEB-INF/pages/" />
    	<property name="suffix" value=".jsp" />
   	</bean>
   	
	<!-- <security:authentication-manager>
   		<security:authentication-provider>
   			<security:user-service>
        		<security:user name="customer1@igate.com" password="password" authorities="ROLE_CUSTOMERGROUP" />
        		<security:user name="abhi" password="password" authorities="ROLE_USER" />
      		</security:user-service>
   		</security:authentication-provider>
	</security:authentication-manager> -->
	
	<security:authentication-manager id="authenticationManager">
   		<security:authentication-provider ref="authenticationProvider"/>
	</security:authentication-manager>
	
	<bean id="authenticationProvider" class="com.security.CoreAuthenticationProvider" scope="singleton">
		<property name="userDetailsService" ref="userDetailService"/>
		<property name="baseMessageSource" ref="baseMessageSource"/>
	</bean>
	
	<bean id="userDetailService" class="com.security.CoreUserDetailService" scope="singleton"/>
	
	<bean id="baseMessageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource" >
		<property name="basenames">
			<list>
				<value>WEB-INF/messages/base</value>
			</list>
		</property>
		<property name="defaultEncoding" value="UTF-8"/>
		<property name="cacheSeconds" value="1"/>
		<property name="fallbackToSystemLocale" value="false"/>
	</bean>
</beans>